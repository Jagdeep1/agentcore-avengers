---
/**
 * Day 3 Overview Page - Infinity War
 * Memory + Tools (Browser, Code Interpreter)
 */

import DayLayout from '@/layouts/DayLayout.astro';
import { getDayOverview, getSectionsInfo } from '@/lib/content';

// Don't build Day 3 in production (GitHub Pages)
if (import.meta.env.PROD) {
  return Astro.redirect('/');
}

const dayNumber = 3;
const overview = await getDayOverview(dayNumber);
const sections = await getSectionsInfo(dayNumber);

const sidebarSections = sections
  .filter((s) => s.order > 0)
  .map((s) => ({ slug: s.slug, title: s.title, order: s.order }));

if (!overview) {
  return Astro.redirect('/');
}

const { Content, headings } = await overview.render();
---

<DayLayout
  title={`Day ${dayNumber}: ${overview.data.avengersTitle}`}
  dayNumber={dayNumber}
  sections={sidebarSections}
  headings={headings}
>
  <Content />
</DayLayout>
