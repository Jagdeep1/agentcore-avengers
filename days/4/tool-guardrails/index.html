<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="https://jagdeep1.github.io/agentcore-avengers/days/4/tool-guardrails/"><!-- Favicon --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><!-- Primary Meta Tags --><title>Tool Guardrails - Day 4 | The AgentCore Initiative</title><meta name="title" content="Tool Guardrails - Day 4 | The AgentCore Initiative"><meta name="description" content="Day 4: Endgame - Guardrails + Observability"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://jagdeep1.github.io/agentcore-avengers/days/4/tool-guardrails/"><meta property="og:title" content="Tool Guardrails - Day 4 | The AgentCore Initiative"><meta property="og:description" content="Day 4: Endgame - Guardrails + Observability"><meta property="og:image" content="https://jagdeep1.github.io/images/og/default.png"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://jagdeep1.github.io/agentcore-avengers/days/4/tool-guardrails/"><meta name="twitter:title" content="Tool Guardrails - Day 4 | The AgentCore Initiative"><meta name="twitter:description" content="Day 4: Endgame - Guardrails + Observability"><meta name="twitter:image" content="https://jagdeep1.github.io/images/og/default.png"><!-- Fonts - Plus Jakarta Sans & Geist Mono --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"><!-- Theme initialization (prevents flash) --><script>
      (function () {
        const stored = localStorage.getItem('agentcore-initiative-progress');
        let theme = 'dark';
        if (stored) {
          try {
            const progress = JSON.parse(stored);
            theme = progress.theme || 'dark';
          } catch (e) {}
        }
        if (theme === 'system') {
          theme = window.matchMedia('(prefers-color-scheme: light)').matches
            ? 'light'
            : 'dark';
        }
        document.documentElement.setAttribute('data-theme', theme);
      })();
    </script><link rel="stylesheet" href="/agentcore-avengers/_astro/_slug_.C6jciWkZ.css">
<style>.pagination[data-astro-cid-gdqvm76k]{display:flex;justify-content:space-between;gap:1rem}.pagination__link[data-astro-cid-gdqvm76k]{flex:1;max-width:50%;padding:1rem 1.25rem;background:var(--color-bg-elevated);border:var(--border-subtle);border-radius:var(--radius-lg);text-decoration:none;transition:all var(--transition-fast)}.pagination__link[data-astro-cid-gdqvm76k]:hover{background:var(--color-bg-secondary);border-color:var(--border-default)}.pagination__link--prev[data-astro-cid-gdqvm76k]{text-align:left}.pagination__link--next[data-astro-cid-gdqvm76k]{text-align:right;margin-left:auto}.pagination__label[data-astro-cid-gdqvm76k]{display:block;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--color-text-muted);margin-bottom:.25rem}.pagination__title[data-astro-cid-gdqvm76k]{display:block;font-size:.9375rem;font-weight:500;color:var(--color-text-primary)}
</style>
<link rel="stylesheet" href="/agentcore-avengers/_astro/_slug_.CP5296fy.css"><style>.callout[data-astro-cid-wi7smz4x]{display:flex;gap:1rem;padding:1rem 1.25rem;border-radius:var(--radius-lg);margin:1.5rem 0;border-left:4px solid}.callout--info[data-astro-cid-wi7smz4x]{background:#3b82f614;border-left-color:var(--color-accent-primary)}.callout--info[data-astro-cid-wi7smz4x] .callout__icon[data-astro-cid-wi7smz4x]{color:var(--color-accent-primary)}.callout--warning[data-astro-cid-wi7smz4x]{background:#f59e0b14;border-left-color:var(--color-accent-warning)}.callout--warning[data-astro-cid-wi7smz4x] .callout__icon[data-astro-cid-wi7smz4x]{color:var(--color-accent-warning)}.callout--danger[data-astro-cid-wi7smz4x]{background:#ef444414;border-left-color:var(--color-accent-danger)}.callout--danger[data-astro-cid-wi7smz4x] .callout__icon[data-astro-cid-wi7smz4x]{color:var(--color-accent-danger)}.callout--success[data-astro-cid-wi7smz4x]{background:#10b98114;border-left-color:var(--color-accent-success)}.callout--success[data-astro-cid-wi7smz4x] .callout__icon[data-astro-cid-wi7smz4x]{color:var(--color-accent-success)}.callout--tip[data-astro-cid-wi7smz4x]{background:#8b5cf614;border-left-color:var(--color-accent-purple)}.callout--tip[data-astro-cid-wi7smz4x] .callout__icon[data-astro-cid-wi7smz4x]{color:var(--color-accent-purple)}.callout__icon[data-astro-cid-wi7smz4x]{flex-shrink:0;width:1.25rem;height:1.25rem;margin-top:.125rem}.callout__content[data-astro-cid-wi7smz4x]{flex:1;min-width:0}.callout__title[data-astro-cid-wi7smz4x]{font-weight:600;font-size:.9375rem;color:var(--color-text-primary);margin-bottom:.25rem}.callout__body[data-astro-cid-wi7smz4x]{font-size:.9375rem;color:var(--color-text-secondary);line-height:1.6}.callout__body[data-astro-cid-wi7smz4x] p{margin:0}.callout__body[data-astro-cid-wi7smz4x] p+p{margin-top:.5rem}.callout__body[data-astro-cid-wi7smz4x] code{font-size:.85em}.callout__body[data-astro-cid-wi7smz4x] a{font-weight:500}
</style></head> <body>  <header class="header" data-astro-cid-mb6pvx4c> <div class="header__container" data-astro-cid-mb6pvx4c> <!-- Logo --> <a href="/agentcore-avengers/" class="header__logo" aria-label="Home" data-astro-cid-mb6pvx4c> <svg class="header__logo-icon" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-mb6pvx4c> <circle cx="16" cy="16" r="14" stroke="currentColor" stroke-width="2" data-astro-cid-mb6pvx4c></circle> <path d="M16 6 L22 12 L16 18 L10 12 Z" fill="currentColor" opacity="0.5" data-astro-cid-mb6pvx4c></path> <circle cx="16" cy="16" r="4" fill="currentColor" data-astro-cid-mb6pvx4c></circle> </svg> <span class="header__logo-text" data-astro-cid-mb6pvx4c>AgentCore Initiative</span> </a> <!-- Desktop Navigation --> <nav class="header__nav hide-mobile" aria-label="Main navigation" data-astro-cid-mb6pvx4c> <ul class="header__nav-list" data-astro-cid-mb6pvx4c> <li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/days" class="header__nav-link header__nav-link--active" data-astro-cid-mb6pvx4c> Course </a> </li><li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/troubleshooting" class="header__nav-link" data-astro-cid-mb6pvx4c> Troubleshooting </a> </li><li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/reference" class="header__nav-link" data-astro-cid-mb6pvx4c> Reference </a> </li> </ul> </nav> <!-- Actions --> <div class="header__actions" data-astro-cid-mb6pvx4c> <!-- Theme Toggle Button (placeholder - will be React component) --> <button id="theme-toggle" class="header__theme-toggle" aria-label="Toggle theme" type="button" data-astro-cid-mb6pvx4c> <svg class="header__theme-icon header__theme-icon--dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-mb6pvx4c> <circle cx="12" cy="12" r="5" data-astro-cid-mb6pvx4c></circle> <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" data-astro-cid-mb6pvx4c></path> </svg> <svg class="header__theme-icon header__theme-icon--light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-mb6pvx4c> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-mb6pvx4c></path> </svg> </button> <!-- Mobile Menu Toggle --> <button id="mobile-menu-toggle" class="header__mobile-toggle hide-desktop" aria-label="Toggle menu" aria-expanded="false" type="button" data-astro-cid-mb6pvx4c> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-mb6pvx4c> <path class="menu-icon" d="M4 6h16M4 12h16M4 18h16" data-astro-cid-mb6pvx4c></path> <path class="close-icon" d="M6 6l12 12M6 18L18 6" style="display: none" data-astro-cid-mb6pvx4c></path> </svg> </button> </div> </div> <!-- Mobile Navigation --> <nav id="mobile-nav" class="header__mobile-nav hide-desktop" aria-label="Mobile navigation" hidden data-astro-cid-mb6pvx4c> <ul class="header__mobile-nav-list" data-astro-cid-mb6pvx4c> <li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/days" class="header__mobile-nav-link header__mobile-nav-link--active" data-astro-cid-mb6pvx4c> Course </a> </li><li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/troubleshooting" class="header__mobile-nav-link" data-astro-cid-mb6pvx4c> Troubleshooting </a> </li><li data-astro-cid-mb6pvx4c> <a href="/agentcore-avengers/reference" class="header__mobile-nav-link" data-astro-cid-mb6pvx4c> Reference </a> </li> </ul> </nav> </header>  <script type="module">const r=document.getElementById("theme-toggle");r&&r.addEventListener("click",()=>{const e=document.documentElement,t=e.getAttribute("data-theme")==="dark"?"light":"dark";e.setAttribute("data-theme",t);const c=localStorage.getItem("agentcore-initiative-progress");let i={theme:t};if(c)try{i={...JSON.parse(c),theme:t}}catch{}localStorage.setItem("agentcore-initiative-progress",JSON.stringify(i))});const n=document.getElementById("mobile-menu-toggle"),l=document.getElementById("mobile-nav");n&&l&&n.addEventListener("click",()=>{const e=n.getAttribute("aria-expanded")==="true";n.setAttribute("aria-expanded",String(!e)),l.hidden=e;const o=n.querySelector(".menu-icon"),t=n.querySelector(".close-icon");o&&t&&(o.style.display=e?"block":"none",t.style.display=e?"none":"block")});</script> <div class="day-layout" style="--day-accent: #10b981" data-astro-cid-vfeiczyy> <!-- Sidebar --> <aside class="day-layout__sidebar hide-mobile" data-astro-cid-vfeiczyy> <div class="day-layout__sidebar-content" data-astro-cid-vfeiczyy> <!-- Day Header --> <div class="day-layout__day-header" data-astro-cid-vfeiczyy> <span class="day-layout__day-number" data-astro-cid-vfeiczyy>Day 4</span> <h2 class="day-layout__day-title" data-astro-cid-vfeiczyy>Endgame</h2> <p class="day-layout__day-focus" data-astro-cid-vfeiczyy>Guardrails + Observability</p> </div> <!-- Section Navigation --> <nav class="day-layout__nav" aria-label="Day sections" data-astro-cid-vfeiczyy> <ul class="day-layout__nav-list" data-astro-cid-vfeiczyy> <li data-astro-cid-vfeiczyy> <a href="/agentcore-avengers/days/4/observability" class="day-layout__nav-link" data-section="observability" data-astro-cid-vfeiczyy> <span class="day-layout__nav-check" aria-hidden="true" data-astro-cid-vfeiczyy> <svg viewBox="0 0 16 16" fill="none" data-astro-cid-vfeiczyy> <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" data-astro-cid-vfeiczyy></circle> <path class="check-mark" d="M5 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-vfeiczyy></path> </svg> </span> Observability </a> </li><li data-astro-cid-vfeiczyy> <a href="/agentcore-avengers/days/4/evaluations" class="day-layout__nav-link" data-section="evaluations" data-astro-cid-vfeiczyy> <span class="day-layout__nav-check" aria-hidden="true" data-astro-cid-vfeiczyy> <svg viewBox="0 0 16 16" fill="none" data-astro-cid-vfeiczyy> <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" data-astro-cid-vfeiczyy></circle> <path class="check-mark" d="M5 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-vfeiczyy></path> </svg> </span> Agent Evaluations </a> </li><li data-astro-cid-vfeiczyy> <a href="/agentcore-avengers/days/4/guardrails-basics" class="day-layout__nav-link" data-section="guardrails-basics" data-astro-cid-vfeiczyy> <span class="day-layout__nav-check" aria-hidden="true" data-astro-cid-vfeiczyy> <svg viewBox="0 0 16 16" fill="none" data-astro-cid-vfeiczyy> <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" data-astro-cid-vfeiczyy></circle> <path class="check-mark" d="M5 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-vfeiczyy></path> </svg> </span> Guardrails Basics </a> </li><li data-astro-cid-vfeiczyy> <a href="/agentcore-avengers/days/4/tool-guardrails" class="day-layout__nav-link day-layout__nav-link--active" data-section="tool-guardrails" data-astro-cid-vfeiczyy> <span class="day-layout__nav-check" aria-hidden="true" data-astro-cid-vfeiczyy> <svg viewBox="0 0 16 16" fill="none" data-astro-cid-vfeiczyy> <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" data-astro-cid-vfeiczyy></circle> <path class="check-mark" d="M5 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-vfeiczyy></path> </svg> </span> Tool Guardrails </a> </li><li data-astro-cid-vfeiczyy> <a href="/agentcore-avengers/days/4/controlled-disasters" class="day-layout__nav-link" data-section="controlled-disasters" data-astro-cid-vfeiczyy> <span class="day-layout__nav-check" aria-hidden="true" data-astro-cid-vfeiczyy> <svg viewBox="0 0 16 16" fill="none" data-astro-cid-vfeiczyy> <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5" data-astro-cid-vfeiczyy></circle> <path class="check-mark" d="M5 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-vfeiczyy></path> </svg> </span> Controlled Disasters </a> </li> </ul> </nav> <!-- Challenge Link --> <a href="/agentcore-avengers/days/4/challenge" class="day-layout__challenge-link" data-astro-cid-vfeiczyy> <span class="day-layout__challenge-icon" data-astro-cid-vfeiczyy> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-vfeiczyy> <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" data-astro-cid-vfeiczyy></polygon> </svg> </span>
Daily Challenge
</a> </div> </aside> <!-- Main Content --> <main class="day-layout__main" data-astro-cid-vfeiczyy> <article class="day-layout__content prose" data-astro-cid-vfeiczyy>  <h1 id="tool-guardrails">Tool Guardrails</h1>
<p>Content guardrails protect inputs and outputs. <strong>Tool guardrails</strong> protect what your agent can <strong>do</strong>.</p>
<h2 id="the-tool-security-model">The Tool Security Model</h2>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-cx8vnfbcp" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="plaintext" id="code-cx8vnfbcp"><code><span class="line"><span>┌─────────────────────────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│                    Tool Execution with Guardrails                    │</span></span>
<span class="line"><span>│                                                                      │</span></span>
<span class="line"><span>│  Agent wants to: execute_python(&quot;import os; os.system(&#39;rm -rf /&#39;)&quot;)│</span></span>
<span class="line"><span>│      │                                                               │</span></span>
<span class="line"><span>│      ▼                                                               │</span></span>
<span class="line"><span>│  ┌──────────────────────────────────────────────────────────────┐   │</span></span>
<span class="line"><span>│  │                CODE INTERPRETER GUARDRAILS                    │   │</span></span>
<span class="line"><span>│  │                                                                │   │</span></span>
<span class="line"><span>│  │  ❌ Blocked import: &#39;os&#39;                                       │   │</span></span>
<span class="line"><span>│  │  ❌ Blocked pattern: &#39;os.system&#39;                               │   │</span></span>
<span class="line"><span>│  │  ✓  Execution time: &lt; 60s                                     │   │</span></span>
<span class="line"><span>│  │  ✓  Memory usage: &lt; 512MB                                     │   │</span></span>
<span class="line"><span>│  └──────────────────────────────────────────────────────────────┘   │</span></span>
<span class="line"><span>│      │                                                               │</span></span>
<span class="line"><span>│      ▼                                                               │</span></span>
<span class="line"><span>│  ❌ EXECUTION BLOCKED                                                │</span></span>
<span class="line"><span>│                                                                      │</span></span>
<span class="line"><span>│  Error: &quot;Code contains blocked imports or patterns&quot;                 │</span></span>
<span class="line"><span>│                                                                      │</span></span>
<span class="line"><span>└─────────────────────────────────────────────────────────────────────┘</span></span></code></pre></div>
<h2 id="code-interpreter-guardrails">Code Interpreter Guardrails</h2>
<h3 id="execution-constraints">Execution Constraints</h3>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-1esk5a9sq" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-1esk5a9sq"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> boto3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">code_client </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> boto3.client(</span><span style="color:#9ECBFF">&#39;bedrock-agentcore-tools&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">region_name</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;us-east-1&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Create Code Interpreter with guardrails</span></span>
<span class="line"><span style="color:#E1E4E8">response </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> code_client.create_code_interpreter(</span></span>
<span class="line"><span style="color:#FFAB70">    name</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;safe-code-interpreter&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    configuration</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;runtime&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;python3.11&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Execution limits</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;timeout&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">,           </span><span style="color:#6A737D"># Max 60 seconds per execution</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;memorySize&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">512</span><span style="color:#E1E4E8">,       </span><span style="color:#6A737D"># Max 512MB memory</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;diskSize&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1024</span><span style="color:#E1E4E8">,        </span><span style="color:#6A737D"># Max 1GB disk space</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Network restrictions</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;networkMode&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;DISABLED&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D"># No internet access</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Import restrictions</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;allowedImports&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;pandas&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;numpy&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;matplotlib&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;seaborn&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;scipy&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;scikit-learn&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Pattern blocking</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockedPatterns&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">__import__</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">eval</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">exec</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">compile</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">subprocess</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">system</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">popen</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">open</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#79B8FF">[</span><span style="color:#F97583">^</span><span style="color:#79B8FF">)]</span><span style="color:#F97583">*</span><span style="color:#79B8FF">[&quot;</span><span style="color:#85E89D;font-weight:bold">\&#39;</span><span style="color:#79B8FF">]</span><span style="color:#DBEDFF">w</span><span style="color:#79B8FF">[&quot;</span><span style="color:#85E89D;font-weight:bold">\&#39;</span><span style="color:#79B8FF">]</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D"># File writes</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # File system restrictions</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;allowedPaths&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;/tmp&#39;</span><span style="color:#E1E4E8">,      </span><span style="color:#6A737D"># Read/write</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;/data&#39;</span><span style="color:#6A737D">      # Read-only</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockedPaths&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;/etc&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;/root&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;/home&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">        ]</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">code_interpreter_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> response[</span><span style="color:#9ECBFF">&#39;codeInterpreterId&#39;</span><span style="color:#E1E4E8">]</span></span></code></pre></div>
<h3 id="import-allowlisting">Import Allowlisting</h3>
<p>Only permit safe, necessary libraries:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-l0989t8wh" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-l0989t8wh"><code><span class="line"><span style="color:#6A737D"># Good: Specific allowlist</span></span>
<span class="line"><span style="color:#E1E4E8">allowed_imports </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;pandas&#39;</span><span style="color:#E1E4E8">,      </span><span style="color:#6A737D"># Data manipulation</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;numpy&#39;</span><span style="color:#E1E4E8">,       </span><span style="color:#6A737D"># Numerical computing</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;matplotlib&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D"># Visualization</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;datetime&#39;</span><span style="color:#E1E4E8">,    </span><span style="color:#6A737D"># Date/time operations</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;json&#39;</span><span style="color:#E1E4E8">,        </span><span style="color:#6A737D"># JSON parsing</span></span>
<span class="line"><span style="color:#9ECBFF">    &#39;re&#39;</span><span style="color:#E1E4E8">,          </span><span style="color:#6A737D"># Regex (safe subset)</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Bad: Too permissive</span></span>
<span class="line"><span style="color:#E1E4E8">allowed_imports </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">&#39;*&#39;</span><span style="color:#E1E4E8">]  </span><span style="color:#6A737D"># Allows everything!</span></span></code></pre></div>
<h3 id="pattern-blocking">Pattern Blocking</h3>
<p>Block dangerous code patterns:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-g3jb3yi1p" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-g3jb3yi1p"><code><span class="line"><span style="color:#E1E4E8">blocked_patterns </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    # Command execution</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">system</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;System command execution&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">subprocess</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Subprocess execution&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">__import__</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Dynamic imports&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Code evaluation</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">eval</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Arbitrary code evaluation&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">exec</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Arbitrary code execution&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">compile</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Code compilation&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # File system access</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">open</span><span style="color:#79B8FF">\s</span><span style="color:#F97583">*</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#79B8FF">[</span><span style="color:#F97583">^</span><span style="color:#79B8FF">)]</span><span style="color:#F97583">*</span><span style="color:#79B8FF">[&quot;</span><span style="color:#85E89D;font-weight:bold">\&#39;</span><span style="color:#79B8FF">][wa][&quot;</span><span style="color:#85E89D;font-weight:bold">\&#39;</span><span style="color:#79B8FF">]</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;File writes&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">remove</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;File deletion&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">shutil</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">rmtree</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Directory deletion&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Network access</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">socket</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Raw socket access&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">urllib</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">request</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;URL requests&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">requests</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;HTTP requests&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Process manipulation</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">fork</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Process forking&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">multiprocessing</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Multiprocessing&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre></div>
<aside class="callout callout--warning" role="note" data-astro-cid-wi7smz4x> <div class="callout__icon" data-astro-cid-wi7smz4x> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-wi7smz4x> <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/> </svg> </div> <div class="callout__content" data-astro-cid-wi7smz4x> <p class="callout__title" data-astro-cid-wi7smz4x>Regex Bypasses</p> <div class="callout__body" data-astro-cid-wi7smz4x> <p>Regex blocking isn’t foolproof. Attackers can obfuscate:</p><div class="code-block-wrapper"><button class="copy-button" data-code-id="code-yyukbiv26" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-yyukbiv26"><code><span class="line"><span style="color:#6A737D"># Blocked: os.system</span></span>
<span class="line"><span style="color:#6A737D"># Bypass: getattr(__import__(&#39;os&#39;), &#39;system&#39;)</span></span></code></pre></div><p>Use multiple layers: import allowlisting + pattern blocking + sandboxing.</p> </div> </div> </aside> 
<h3 id="resource-limits">Resource Limits</h3>
<p>Prevent resource exhaustion:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-jvzlzk5rv" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-jvzlzk5rv"><code><span class="line"><span style="color:#6A737D"># Timeout example</span></span>
<span class="line"><span style="color:#F97583">with</span><span style="color:#E1E4E8"> CodeInterpreterSession(</span><span style="color:#FFAB70">code_interpreter_id</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;ci-xxxx&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> session:</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">        # This infinite loop will timeout after 60s</span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> session.execute(</span><span style="color:#9ECBFF">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF">while True:</span></span>
<span class="line"><span style="color:#9ECBFF">    x = 1 + 1</span></span>
<span class="line"><span style="color:#9ECBFF">&quot;&quot;&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> TimeoutError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">        print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;Execution exceeded time limit&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Memory limit example</span></span>
<span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # This will fail when memory exceeds 512MB</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> session.execute(</span><span style="color:#9ECBFF">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF">data = []</span></span>
<span class="line"><span style="color:#9ECBFF">for i in range(10**9):</span></span>
<span class="line"><span style="color:#9ECBFF">    data.append(i)</span></span>
<span class="line"><span style="color:#9ECBFF">&quot;&quot;&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#79B8FF"> MemoryError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;Execution exceeded memory limit&quot;</span><span style="color:#E1E4E8">)</span></span></code></pre></div>
<h3 id="validation-wrapper">Validation Wrapper</h3>
<p>Add validation before execution:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-g148sjm71" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-g148sjm71"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> re</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> strands.tools </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> tool</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> bedrock_agentcore.tools </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> CodeInterpreterSession</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> validate_code</span><span style="color:#E1E4E8">(code: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; tuple[</span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Validate code before execution.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Returns:</span></span>
<span class="line"><span style="color:#9ECBFF">        (is_valid, error_message)</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6A737D">    # Check for blocked patterns</span></span>
<span class="line"><span style="color:#E1E4E8">    blocked </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">__import__</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Dynamic imports not allowed&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">eval</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;eval() not allowed&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">exec</span><span style="color:#85E89D;font-weight:bold">\(</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;exec() not allowed&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">os</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">system</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;System commands not allowed&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">        r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#DBEDFF">subprocess</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Subprocess not allowed&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> pattern, message </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> blocked.items():</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> re.search(pattern, code):</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Code validation failed: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">message</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Check imports</span></span>
<span class="line"><span style="color:#E1E4E8">    imports </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.findall(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">&#39;</span><span style="color:#79B8FF">^\s</span><span style="color:#F97583">*</span><span style="color:#79B8FF">(?:</span><span style="color:#DBEDFF">import</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">from</span><span style="color:#79B8FF">)\s</span><span style="color:#F97583">+</span><span style="color:#79B8FF">(\w</span><span style="color:#F97583">+</span><span style="color:#79B8FF">)</span><span style="color:#9ECBFF">&#39;</span><span style="color:#E1E4E8">, code, re.</span><span style="color:#79B8FF">MULTILINE</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    allowed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span><span style="color:#9ECBFF">&#39;pandas&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;numpy&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;matplotlib&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;datetime&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;json&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;re&#39;</span><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> imp </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> imports:</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> imp </span><span style="color:#F97583">not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> allowed:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Import &#39;</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">imp</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&#39; not allowed&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Check code length</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(code) </span><span style="color:#F97583">&gt;</span><span style="color:#79B8FF"> 10000</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&quot;Code too long (max 10000 characters)&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> True</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@tool</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> execute_python_safe</span><span style="color:#E1E4E8">(code: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Execute Python code with validation.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Args:</span></span>
<span class="line"><span style="color:#9ECBFF">        code: Python code to execute</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Returns:</span></span>
<span class="line"><span style="color:#9ECBFF">        Execution output or error message</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6A737D">    # Validate first</span></span>
<span class="line"><span style="color:#E1E4E8">    valid, error </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> validate_code(code)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> valid:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">&quot;❌ </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">error</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Execute with timeout</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#E1E4E8"> CodeInterpreterSession(</span><span style="color:#FFAB70">code_interpreter_id</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;ci-xxxx&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> session:</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> session.execute(code)</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#E1E4E8"> result.output</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> TimeoutError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#9ECBFF"> &quot;❌ Execution timeout (max 60 seconds)&quot;</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> MemoryError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#9ECBFF"> &quot;❌ Memory limit exceeded (max 512MB)&quot;</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">&quot;❌ Execution error: </span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(e)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span></code></pre></div>
<h2 id="browser-guardrails">Browser Guardrails</h2>
<h3 id="url-allowlisting">URL Allowlisting</h3>
<p>Restrict which domains the agent can visit:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-rr4natgjp" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-rr4natgjp"><code><span class="line"><span style="color:#6A737D"># Create Browser with URL restrictions</span></span>
<span class="line"><span style="color:#E1E4E8">browser_response </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> code_client.create_browser(</span></span>
<span class="line"><span style="color:#FFAB70">    name</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;safe-browser&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    configuration</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;headless&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;timeout&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">30</span><span style="color:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # URL allowlist</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;allowedDomains&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;*.wikipedia.org&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;*.github.com&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;docs.python.org&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;stackoverflow.com&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # URL blocklist (takes precedence)</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockedDomains&#39;</span><span style="color:#E1E4E8">: [</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;localhost&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;127.0.0.1&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;*.internal&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;*.local&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;10.*&#39;</span><span style="color:#E1E4E8">,      </span><span style="color:#6A737D"># Private IP ranges</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;172.16.*&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;192.168.*&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">        ],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Navigation limits</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;maxNavigations&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">,    </span><span style="color:#6A737D"># Max 10 page loads per session</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;maxRedirects&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">,       </span><span style="color:#6A737D"># Max 3 redirects per navigation</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Security settings</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockThirdPartyCookies&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockJavaScript&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D"># May break sites, test carefully</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;blockPopups&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">browser_id </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browser_response[</span><span style="color:#9ECBFF">&#39;browserId&#39;</span><span style="color:#E1E4E8">]</span></span></code></pre></div>
<h3 id="url-validation">URL Validation</h3>
<p>Validate URLs before navigation:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-13duwrpbh" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-13duwrpbh"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> urllib.parse </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> urlparse</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ipaddress</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> is_url_allowed</span><span style="color:#E1E4E8">(url: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, allowed_domains: list[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">], blocked_domains: list[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">]) -&gt; tuple[</span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Check if URL is allowed.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Returns:</span></span>
<span class="line"><span style="color:#9ECBFF">        (is_allowed, reason)</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        parsed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> urlparse(url)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Check scheme</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> parsed.scheme </span><span style="color:#F97583">not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">&#39;http&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;https&#39;</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Scheme &#39;</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">parsed.scheme</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&#39; not allowed&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Check for IP addresses (often internal)</span></span>
<span class="line"><span style="color:#E1E4E8">        hostname </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> parsed.hostname</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            ip </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ipaddress.ip_address(hostname)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> ip.is_private </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> ip.is_loopback:</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&quot;Private/loopback IPs not allowed&quot;</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            pass</span><span style="color:#6A737D">  # Not an IP, continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Check blocklist first</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> blocked </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> blocked_domains:</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> matches_pattern(hostname, blocked):</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Domain blocked: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">blocked</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">        # Check allowlist</span></span>
<span class="line"><span style="color:#E1E4E8">        allowed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> pattern </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> allowed_domains:</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> matches_pattern(hostname, pattern):</span></span>
<span class="line"><span style="color:#E1E4E8">                allowed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> True</span></span>
<span class="line"><span style="color:#F97583">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> allowed:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Domain not in allowlist&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> True</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> False</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Invalid URL: </span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(e)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> matches_pattern</span><span style="color:#E1E4E8">(hostname: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, pattern: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Check if hostname matches domain pattern.&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6A737D">    # Handle wildcards</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> pattern.startswith(</span><span style="color:#9ECBFF">&#39;*.&#39;</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> hostname.endswith(pattern[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">:])</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> hostname </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> pattern</span></span></code></pre></div>
<h3 id="browser-tool-with-validation">Browser Tool with Validation</h3>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-r3zr8lk34" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-r3zr8lk34"><code><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> strands.tools </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> tool</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> bedrock_agentcore.tools </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> BrowserSession</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@tool</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> browse_website_safe</span><span style="color:#E1E4E8">(url: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, action: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> &quot;screenshot&quot;</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Browse a website safely with URL validation.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Args:</span></span>
<span class="line"><span style="color:#9ECBFF">        url: URL to visit</span></span>
<span class="line"><span style="color:#9ECBFF">        action: Action to perform (screenshot, get_text, get_links)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Returns:</span></span>
<span class="line"><span style="color:#9ECBFF">        Result or error message</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6A737D">    # Validate URL</span></span>
<span class="line"><span style="color:#E1E4E8">    allowed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">&#39;*.wikipedia.org&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;*.github.com&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;docs.python.org&#39;</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">    blocked </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">&#39;localhost&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;*.internal&#39;</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    is_allowed, reason </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> is_url_allowed(url, allowed, blocked)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> is_allowed:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">&quot;❌ URL not allowed: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">reason</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Navigate with safeguards</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#E1E4E8"> BrowserSession(</span><span style="color:#FFAB70">browser_id</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;br-xxxx&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> browser:</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            browser.navigate(url)</span></span>
<span class="line"><span style="color:#E1E4E8">            browser.wait_for_load(</span><span style="color:#FFAB70">timeout</span><span style="color:#F97583">=</span><span style="color:#79B8FF">30</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> action </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> &quot;screenshot&quot;</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                screenshot </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browser.screenshot()</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">&quot;Screenshot captured: </span><span style="color:#79B8FF">{len</span><span style="color:#E1E4E8">(screenshot)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> bytes&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">            elif</span><span style="color:#E1E4E8"> action </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> &quot;get_text&quot;</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                text </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browser.get_text()</span></span>
<span class="line"><span style="color:#6A737D">                # Limit output size</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#E1E4E8"> text[:</span><span style="color:#79B8FF">5000</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">            elif</span><span style="color:#E1E4E8"> action </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> &quot;get_links&quot;</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                links </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browser.get_links()</span></span>
<span class="line"><span style="color:#6A737D">                # Filter links to allowed domains</span></span>
<span class="line"><span style="color:#E1E4E8">                safe_links </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#E1E4E8">                    link </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> link </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> links[:</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#F97583">                    if</span><span style="color:#E1E4E8"> is_url_allowed(link[</span><span style="color:#9ECBFF">&#39;href&#39;</span><span style="color:#E1E4E8">], allowed, blocked)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">                ]</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#9ECBFF"> &quot;</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">.join([</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;- </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">l[</span><span style="color:#9ECBFF">&#39;text&#39;</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">l[</span><span style="color:#9ECBFF">&#39;href&#39;</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#F97583"> for</span><span style="color:#E1E4E8"> l </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> safe_links])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> TimeoutError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#9ECBFF"> &quot;❌ Navigation timeout&quot;</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">&quot;❌ Browser error: </span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(e)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span></code></pre></div>
<h2 id="custom-tool-guardrails">Custom Tool Guardrails</h2>
<p>For your own tools, implement similar patterns:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-gqqwe1qah" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-gqqwe1qah"><code><span class="line"><span style="color:#B392F0">@tool</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> database_query_safe</span><span style="color:#E1E4E8">(query: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Execute database query with safety checks.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Args:</span></span>
<span class="line"><span style="color:#9ECBFF">        query: SQL query to execute</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF">    Returns:</span></span>
<span class="line"><span style="color:#9ECBFF">        Query results or error</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#6A737D">    # Validation layer</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> is_query_safe(query):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#9ECBFF"> &quot;❌ Query contains dangerous operations&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Parameter sanitization</span></span>
<span class="line"><span style="color:#E1E4E8">    query </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> sanitize_query(query)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Read-only enforcement</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> query.strip().upper().startswith(</span><span style="color:#9ECBFF">&#39;SELECT&#39;</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#9ECBFF"> &quot;❌ Only SELECT queries allowed&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Row limit</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#9ECBFF"> &#39;LIMIT&#39;</span><span style="color:#F97583"> not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> query.upper():</span></span>
<span class="line"><span style="color:#E1E4E8">        query </span><span style="color:#F97583">+=</span><span style="color:#9ECBFF"> &#39; LIMIT 100&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Timeout</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> execute_with_timeout(query, </span><span style="color:#FFAB70">timeout</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> format_results(result)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> TimeoutError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#9ECBFF"> &quot;❌ Query timeout&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> is_query_safe</span><span style="color:#E1E4E8">(query: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Check for SQL injection and dangerous operations.&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">    dangerous </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">&#39;DROP&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;DELETE&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;UPDATE&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;INSERT&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;TRUNCATE&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;ALTER&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;CREATE&#39;</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">    query_upper </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> query.upper()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> keyword </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> dangerous:</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> keyword </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> query_upper:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> True</span></span></code></pre></div>
<h2 id="testing-tool-guardrails">Testing Tool Guardrails</h2>
<h3 id="code-interpreter-test-suite">Code Interpreter Test Suite</h3>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-u3amrdd0d" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-u3amrdd0d"><code><span class="line"><span style="color:#6A737D"># test_code_guardrails.py</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pytest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">test_cases </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#6A737D">    # Should block</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;code&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;import os; os.system(&quot;ls&quot;)&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;should_block&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;reason&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Blocked import (os)&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;code&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;__import__(&quot;subprocess&quot;).run([&quot;ls&quot;])&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;should_block&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;reason&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Dynamic import&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;code&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;while True: pass&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;should_block&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;reason&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Timeout (infinite loop)&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Should allow</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;code&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;import pandas as pd; df = pd.DataFrame({&quot;a&quot;: [1, 2, 3]}); print(df)&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;should_block&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;reason&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Safe pandas usage&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;code&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;x = [i**2 for i in range(100)]; print(sum(x))&#39;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;should_block&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &#39;reason&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&#39;Safe computation&#39;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@pytest.mark.parametrize</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;case&#39;</span><span style="color:#E1E4E8">, test_cases)</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> test_code_guardrail</span><span style="color:#E1E4E8">(case):</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> execute_python_safe(case[</span><span style="color:#9ECBFF">&#39;code&#39;</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> case[</span><span style="color:#9ECBFF">&#39;should_block&#39;</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#F97583">        assert</span><span style="color:#E1E4E8"> result.startswith(</span><span style="color:#9ECBFF">&#39;❌&#39;</span><span style="color:#E1E4E8">), </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Expected block: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">case[</span><span style="color:#9ECBFF">&#39;reason&#39;</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        assert</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> result.startswith(</span><span style="color:#9ECBFF">&#39;❌&#39;</span><span style="color:#E1E4E8">), </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Should allow: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">case[</span><span style="color:#9ECBFF">&#39;reason&#39;</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span></code></pre></div>
<h3 id="browser-test-suite">Browser Test Suite</h3>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-t0inoq8g6" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-t0inoq8g6"><code><span class="line"><span style="color:#6A737D"># test_browser_guardrails.py</span></span>
<span class="line"><span style="color:#E1E4E8">test_urls </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#6A737D">    # Should block</span></span>
<span class="line"><span style="color:#E1E4E8">    (</span><span style="color:#9ECBFF">&#39;http://localhost:8080&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;Localhost access&#39;</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">    (</span><span style="color:#9ECBFF">&#39;http://192.168.1.1&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;Private IP&#39;</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">    (</span><span style="color:#9ECBFF">&#39;https://evil-site.com&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;Not in allowlist&#39;</span><span style="color:#E1E4E8">),</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Should allow</span></span>
<span class="line"><span style="color:#E1E4E8">    (</span><span style="color:#9ECBFF">&#39;https://en.wikipedia.org&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;Wikipedia allowed&#39;</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">    (</span><span style="color:#9ECBFF">&#39;https://github.com/aws&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;GitHub allowed&#39;</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@pytest.mark.parametrize</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;url,should_block,reason&#39;</span><span style="color:#E1E4E8">, test_urls)</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> test_browser_guardrail</span><span style="color:#E1E4E8">(url, should_block, reason):</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> browse_website_safe(url)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> should_block:</span></span>
<span class="line"><span style="color:#F97583">        assert</span><span style="color:#E1E4E8"> result.startswith(</span><span style="color:#9ECBFF">&#39;❌&#39;</span><span style="color:#E1E4E8">), </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Expected block: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">reason</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        assert</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> result.startswith(</span><span style="color:#9ECBFF">&#39;❌&#39;</span><span style="color:#E1E4E8">), </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Should allow: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">reason</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span></span></code></pre></div>
<h2 id="monitoring-tool-usage">Monitoring Tool Usage</h2>
<p>Track what tools are doing:</p>
<div class="code-block-wrapper"><button class="copy-button" data-code-id="code-122agl25c" aria-label="Copy code to clipboard" type="button"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg><svg class="check-icon hidden" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></button><pre class="code-block" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="python" id="code-122agl25c"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> logging</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> functools </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> wraps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> log_tool_call</span><span style="color:#E1E4E8">(func):</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;&quot;&quot;Decorator to log all tool calls.&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#B392F0">    @wraps</span><span style="color:#E1E4E8">(func)</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> wrapper</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">*</span><span style="color:#E1E4E8">args, </span><span style="color:#F97583">**</span><span style="color:#E1E4E8">kwargs):</span></span>
<span class="line"><span style="color:#E1E4E8">        logging.info(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Tool call: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">func.</span><span style="color:#79B8FF">__name__}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">extra</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;args&#39;</span><span style="color:#E1E4E8">: args,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;kwargs&#39;</span><span style="color:#E1E4E8">: kwargs,</span></span>
<span class="line"><span style="color:#9ECBFF">            &#39;tool&#39;</span><span style="color:#E1E4E8">: func.</span><span style="color:#79B8FF">__name__</span></span>
<span class="line"><span style="color:#E1E4E8">        })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> func(</span><span style="color:#F97583">*</span><span style="color:#E1E4E8">args, </span><span style="color:#F97583">**</span><span style="color:#E1E4E8">kwargs)</span></span>
<span class="line"><span style="color:#E1E4E8">            logging.info(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Tool success: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">func.</span><span style="color:#79B8FF">__name__}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">extra</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">                &#39;tool&#39;</span><span style="color:#E1E4E8">: func.</span><span style="color:#79B8FF">__name__</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                &#39;result_length&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(result))</span></span>
<span class="line"><span style="color:#E1E4E8">            })</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#E1E4E8"> result</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#E1E4E8">            logging.error(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Tool error: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">func.</span><span style="color:#79B8FF">__name__}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">extra</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">                &#39;tool&#39;</span><span style="color:#E1E4E8">: func.</span><span style="color:#79B8FF">__name__</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                &#39;error&#39;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(e)</span></span>
<span class="line"><span style="color:#E1E4E8">            })</span></span>
<span class="line"><span style="color:#F97583">            raise</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> wrapper</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@tool</span></span>
<span class="line"><span style="color:#B392F0">@log_tool_call</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> execute_python_safe</span><span style="color:#E1E4E8">(code: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#6A737D">    # Implementation...</span></span>
<span class="line"><span style="color:#F97583">    pass</span></span></code></pre></div>
<h2 id="checkpoint">Checkpoint</h2>
<p>You’ve now learned:</p>
<ul>
<li>✅ Code Interpreter execution limits and import restrictions</li>
<li>✅ Browser URL allowlisting and navigation constraints</li>
<li>✅ Custom tool validation patterns</li>
<li>✅ Testing tool guardrails</li>
<li>✅ Monitoring tool usage</li>
</ul>
<p><strong>Next, we’ll add comprehensive observability to see everything your agent does.</strong></p>
<div class="nav-buttons"><a href="/days/4/guardrails-basics" class="nav-button nav-button--prev"><p>← Guardrails Basics</p></a><a href="/days/4/controlled-disasters" class="nav-button nav-button--next"><p>Next: Controlled Disasters →</p></a></div>
<style>
.nav-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 3rem;
  gap: 1rem;
}

.nav-button {
  padding: 0.75rem 1.5rem;
  font-weight: 500;
  text-decoration: none;
  border-radius: var(--radius-md);
  transition: all 0.2s ease;
}

.nav-button--prev {
  color: var(--color-text-secondary);
  background: var(--color-bg-elevated);
  border: 1px solid var(--border-subtle);
}

.nav-button--prev:hover {
  background: var(--color-bg-secondary);
}

.nav-button--next {
  color: white;
  background: var(--color-day-4);
}

.nav-button--next:hover {
  opacity: 0.9;
}
</style>   </article> <!-- Navigation Footer --> <nav class="day-layout__pagination" aria-label="Page navigation" data-astro-cid-vfeiczyy>  <div class="pagination" data-astro-cid-gdqvm76k> <a href="/agentcore-avengers/days/4/guardrails-basics" class="pagination__link pagination__link--prev" data-astro-cid-gdqvm76k> <span class="pagination__label" data-astro-cid-gdqvm76k>Previous</span> <span class="pagination__title" data-astro-cid-gdqvm76k>Guardrails Basics</span> </a> <a href="/agentcore-avengers/days/4/controlled-disasters" class="pagination__link pagination__link--next" data-astro-cid-gdqvm76k> <span class="pagination__label" data-astro-cid-gdqvm76k>Next</span> <span class="pagination__title" data-astro-cid-gdqvm76k>Controlled Disasters</span> </a> </div>  </nav> </main> <!-- Table of Contents --> <aside class="day-layout__toc hide-mobile" data-astro-cid-vfeiczyy> <div class="day-layout__toc-content" data-astro-cid-vfeiczyy> <h3 class="day-layout__toc-title" data-astro-cid-vfeiczyy>On this page</h3> <nav aria-label="Table of contents" data-astro-cid-vfeiczyy> <ul class="day-layout__toc-list" data-astro-cid-vfeiczyy> <li data-astro-cid-vfeiczyy> <a href="#the-tool-security-model" class="day-layout__toc-link" data-astro-cid-vfeiczyy> The Tool Security Model </a> </li><li data-astro-cid-vfeiczyy> <a href="#code-interpreter-guardrails" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Code Interpreter Guardrails </a> </li><li data-astro-cid-vfeiczyy> <a href="#execution-constraints" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Execution Constraints </a> </li><li data-astro-cid-vfeiczyy> <a href="#import-allowlisting" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Import Allowlisting </a> </li><li data-astro-cid-vfeiczyy> <a href="#pattern-blocking" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Pattern Blocking </a> </li><li data-astro-cid-vfeiczyy> <a href="#resource-limits" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Resource Limits </a> </li><li data-astro-cid-vfeiczyy> <a href="#validation-wrapper" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Validation Wrapper </a> </li><li data-astro-cid-vfeiczyy> <a href="#browser-guardrails" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Browser Guardrails </a> </li><li data-astro-cid-vfeiczyy> <a href="#url-allowlisting" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> URL Allowlisting </a> </li><li data-astro-cid-vfeiczyy> <a href="#url-validation" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> URL Validation </a> </li><li data-astro-cid-vfeiczyy> <a href="#browser-tool-with-validation" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Browser Tool with Validation </a> </li><li data-astro-cid-vfeiczyy> <a href="#custom-tool-guardrails" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Custom Tool Guardrails </a> </li><li data-astro-cid-vfeiczyy> <a href="#testing-tool-guardrails" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Testing Tool Guardrails </a> </li><li data-astro-cid-vfeiczyy> <a href="#code-interpreter-test-suite" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Code Interpreter Test Suite </a> </li><li data-astro-cid-vfeiczyy> <a href="#browser-test-suite" class="day-layout__toc-link day-layout__toc-link--nested" data-astro-cid-vfeiczyy> Browser Test Suite </a> </li><li data-astro-cid-vfeiczyy> <a href="#monitoring-tool-usage" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Monitoring Tool Usage </a> </li><li data-astro-cid-vfeiczyy> <a href="#checkpoint" class="day-layout__toc-link" data-astro-cid-vfeiczyy> Checkpoint </a> </li> </ul> </nav> </div> </aside> </div> <footer class="footer" data-astro-cid-b2avyow5> <div class="footer__container" data-astro-cid-b2avyow5> <div class="footer__content" data-astro-cid-b2avyow5> <div class="footer__brand" data-astro-cid-b2avyow5> <span class="footer__logo" data-astro-cid-b2avyow5>AgentCore Initiative</span> <p class="footer__tagline" data-astro-cid-b2avyow5>
Build production-ready AI agents with AWS AgentCore
</p> </div> <nav class="footer__nav" aria-label="Footer navigation" data-astro-cid-b2avyow5> <div class="footer__nav-section" data-astro-cid-b2avyow5> <h4 class="footer__nav-title" data-astro-cid-b2avyow5>Course</h4> <ul class="footer__nav-list" data-astro-cid-b2avyow5> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/days/1" data-astro-cid-b2avyow5>Day 1: The First Avenger</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/days/2" data-astro-cid-b2avyow5>Day 2: Age of Ultron</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/days/3" data-astro-cid-b2avyow5>Day 3: Infinity War</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/days/4" data-astro-cid-b2avyow5>Day 4: Endgame</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/days/5" data-astro-cid-b2avyow5>Day 5: Assemble</a></li> </ul> </div> <div class="footer__nav-section" data-astro-cid-b2avyow5> <h4 class="footer__nav-title" data-astro-cid-b2avyow5>Resources</h4> <ul class="footer__nav-list" data-astro-cid-b2avyow5> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/troubleshooting" data-astro-cid-b2avyow5>Troubleshooting</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/reference/costs" data-astro-cid-b2avyow5>Cost Guide</a></li> <li data-astro-cid-b2avyow5><a href="/agentcore-avengers/reference/cleanup" data-astro-cid-b2avyow5>Cleanup</a></li> </ul> </div> <div class="footer__nav-section" data-astro-cid-b2avyow5> <h4 class="footer__nav-title" data-astro-cid-b2avyow5>Links</h4> <ul class="footer__nav-list" data-astro-cid-b2avyow5> <li data-astro-cid-b2avyow5> <a href="https://docs.aws.amazon.com/bedrock-agentcore/" target="_blank" rel="noopener noreferrer" data-astro-cid-b2avyow5>
AWS AgentCore Docs
</a> </li> <li data-astro-cid-b2avyow5> <a href="https://github.com/awslabs/amazon-bedrock-agentcore-samples" target="_blank" rel="noopener noreferrer" data-astro-cid-b2avyow5>
AgentCore Samples
</a> </li> <li data-astro-cid-b2avyow5> <a href="https://strandsagents.com" target="_blank" rel="noopener noreferrer" data-astro-cid-b2avyow5>
Strands Agents
</a> </li> </ul> </div> </nav> </div> <div class="footer__bottom" data-astro-cid-b2avyow5> <p class="footer__copyright" data-astro-cid-b2avyow5>
&copy; 2026 The AgentCore Initiative. Built with Astro.
</p> <p class="footer__disclaimer" data-astro-cid-b2avyow5>
This is an educational resource. AWS and Amazon Bedrock are trademarks of Amazon.com, Inc.
</p> </div> </div> </footer>   <!-- Global scripts --> <script type="module">function d(){document.querySelectorAll(".copy-button").forEach(c=>{const e=c.cloneNode(!0);c.parentNode?.replaceChild(e,c),e.addEventListener("click",async()=>{const i=e.getAttribute("data-code-id"),n=document.getElementById(i);if(!n)return;const s=n.textContent||"";try{await navigator.clipboard.writeText(s);const t=e.querySelector(".copy-icon"),o=e.querySelector(".check-icon");t&&t.classList.add("hidden"),o&&o.classList.remove("hidden"),e.classList.add("copied"),setTimeout(()=>{t&&t.classList.remove("hidden"),o&&o.classList.add("hidden"),e.classList.remove("copied")},2e3)}catch(t){console.error("Failed to copy code:",t)}})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d();document.addEventListener("astro:page-load",d);</script> <!-- Copy code functionality --> <script type="module" src="/agentcore-avengers/_astro/BaseLayout.astro_astro_type_script_index_1_lang.BwEjmFOO.js"></script> </body> </html>   <script type="module" src="/agentcore-avengers/_astro/DayLayout.astro_astro_type_script_index_0_lang.BT_UbId1.js"></script> 